!function(){"use strict";var v={listSelector:function(){return null===app.activeVueModel?"[data-edit-list][data-template-id],[data-edit-list][data-template-url]":"[data-edit-list]"},setuplistEditorControls:function(){var t=this,e=document.querySelectorAll(v.listSelector());Array.prototype.forEach.call(e,function(e){try{t.setuplistEditorControl(e)}catch(t){app.showError(e,t)}})},setuplistEditorControl:function(t){for(var e,a,l,i,p,r,o,n=t.getAttribute("data-edit-list"),d=t.querySelectorAll("[data-list-item]"),c=t.querySelector("[data-add-item]"),u=0,s=d.length;u<s;u++){for(i=0,p=(e=d[u].querySelectorAll('[name^="item-field-"]')).length;i<p;i++)"INPUT"!==(r=e[i].nodeName)&&"TEXTAREA"!==r&&"SELECT"!==r||(e[i].setAttribute("data-array",n),e[i].setAttribute("data-index",u),r=void 0===e[i].oninput?"change":"input",o=e[i].type,e[i].addEventListener(r="checkbox"!==o&&"radio"!==o?r:"change",v.listItemValueChanged));null!==(l=d[u].querySelector("[data-delete-button]"))&&(l.setAttribute("data-array",n),l.setAttribute("data-index",u),l.addEventListener("click",v.listItemDeleteClick),l.style.cursor="pointer")}null!==c&&null!==(a=c.querySelector("[data-add-button]"))&&(a.setAttribute("data-array",n),a.style.cursor="pointer",a.addEventListener("click",v.listItemAddClick)),void 0!==app.events&&"function"==typeof app.events.dispatch&&app.events.dispatch("listEditor.loadedListEditorControl",t)},getFormFieldValue:function(t){var e,a=t.nodeName,l=t.type,i=t.getAttribute("data-type"),r=null;switch(""===(r="INPUT"===a||"SELECT"===a||"TEXTAREA"===a?"checkbox"===l||"radio"===l?t.checked:t.value:t.textContent.trim())&&(r=null),i){case"int":e=parseInt(r,10),isNaN(e)||(r=e);break;case"float":e=parseFloat(r),isNaN(e)||(r=e)}return r},listItemValueChanged:function(t){var t=t.target,e=t.getAttribute("data-array"),a=t.getAttribute("data-index"),l=t.name.substring(11),t=v.getFormFieldValue(t);app.activeVueModel&&app.activeVueModel[e]?(app.activeVueModel[e][a][l]=t,app.isUsingVue3()&&(app.activeVueModel[e]=app.activeVueModel[e].slice())):app.activeModel[e][a][l]=t},listItemAddClick:function(t){for(var e,a,t=t.target,l=t.getAttribute("data-array"),i=v.getParentControl(t),r={},o=i.querySelector("[data-add-item]").querySelectorAll('[name^="item-field-"]'),n=0,d=o.length;n<d;n++)e=o[n].name.substring(11),a=v.getFormFieldValue(o[n]),r[e]=a;app.activeVueModel&&app.activeVueModel[l]?(app.activeVueModel[l].push(r),app.activeVueModel.$nextTick(function(){v.setuplistEditorControl(i),Array.prototype.forEach.call(o,function(t){var e=t.nodeName,a=t.type,l=t.getAttribute("data-default");"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e||("checkbox"===a||"radio"===a?t.checked=null!==l&&"true"===l:t.value=null===l?"":l)})})):(app.activeModel[l].push(r),v.reloadListEditorControl(i))},listItemDeleteClick:function(t){var t=t.target,e=t.getAttribute("data-array"),a=parseInt(t.getAttribute("data-index"),10),t=v.getParentControl(t);app.activeVueModel&&app.activeVueModel[e]?app.activeVueModel[e].splice(a,1):(app.activeModel[e].splice(a,1),v.reloadListEditorControl(t))},getParentControl:function(t){var e=t.parentNode;if(null!==app.activeVueModel)for(;null!==e&&null===e.getAttribute("data-edit-list");)e=e.parentNode;else for(;null!==e&&null===e.getAttribute("data-edit-list")&&null===e.getAttribute("data-template-url")&&null===e.getAttribute("data-template-id");)e=e.parentNode;return e},reloadListEditorControl:function(t){app.refreshHtmlControl(t,function(){v.setuplistEditorControl(t)})},validate:function(){var i=void 0!==app.validation&&"function"==typeof app.validation.validateInput?app.validation.validateInput:null;if(null===i)return console.warn("[app.plugins.listEditor.validate()] was called, however no validation function exists."),[];var r=[],t=document.querySelectorAll(v.listSelector());return Array.prototype.forEach.call(t,function(t){var e=1,a=t.querySelectorAll("[data-list-item]"),l=t.getAttribute("data-list-label");Array.prototype.forEach.call(a,function(t){t=t.querySelectorAll('input[name^="item-field-"], select[name^="item-field-"], textarea[name^="item-field-"]');Array.prototype.forEach.call(t,function(t){t=i(t,null,e,l);t&&r.push(t)}),e++})}),r},onRendered:function(){this.setuplistEditorControls()}};app.addPlugin("listEditor",v)}();