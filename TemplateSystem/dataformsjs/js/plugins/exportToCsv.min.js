!function(){"use strict";function b(e){return e=0<=(e=e.trim().replace(/"/g,'""')).search(/("|,|\n|:)/g)?'"'+e+'"':e}var r={exportTable:function(e,t,s){var o,n,r,u,l,p,v,a,c,e=document.querySelector(e),i=[],d=[];for(t=t||"Report.csv",r=(o=e.tHead.rows[n=0]).cells.length;n<r;n++)d.push(b(o.cells[n].textContent));for(i.push(d.join(",")),p=(u=e.tBodies[l=0].rows).length;l<p;l++)if(d=[],o=u[l],s||"none"!==o.style.display){for(n=0,r=o.cells.length;n<r;n++)null===(a=(v=o.cells[n]).getAttribute("data-value"))&&(a=v.textContent),d.push(b(a));i.push(d.join(","))}e=i.join("\r\n"),e=new Blob([e],{type:"text/csv; charset=utf-8;"}),void 0!==navigator.msSaveBlob?navigator.msSaveBlob(e,t):void 0!==(c=document.createElement("a")).download?(e=URL.createObjectURL(e),c.setAttribute("href",e),c.setAttribute("download",t),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)):app.showErrorAlert("Unable to Export as a CSV File. Try a different browser and if you need help then please contact support.")},onRendered:function(e){var t,e=(e||document).querySelectorAll("[data-export-csv-selector]"),o=!1;0<e.length&&(null===(t=document.querySelector("a"))&&(t=document.createElement("a")),o=void 0!==navigator.msSaveBlob||void 0!==t.download),Array.prototype.forEach.call(e,function(n){o?n.onclick=function(){var e=n.getAttribute("data-export-csv-selector"),t=n.getAttribute("data-export-file-name"),o=null!==n.getAttribute("data-export-all");r.exportTable(e,t,o)}:n.style.display="none"})}};app.addPlugin("exportToCsv",r)}();