!function(){"use strict";app.addControl("data-table",{data:{bind:null,columns:null,labels:null,emptyDataText:"No records found",errorInvalidData:"Error invalid data for table",errorClass:null,defaultErrorStyle:"color:white; background-color:red; padding:0.5rem 1rem; margin:.5rem;",highlightClass:null,tableAttr:null,colClass:null,colLinkTemplate:null,colLinkFields:null,rowItemName:null},onLoad:function(r,t){var e,l,a,u,h,c,d,m,s,f=r.querySelector("template:not([data-footer])"),g=(null===f&&(f=r.querySelector('script[type="text/x-template"]:not([data-footer])')),r.querySelector("template[data-footer]"));function b(t){var e;null===f&&null===g?r.innerHTML=t:(null!==f||null!==g?null!==(e=r.querySelector("table"))&&e.parentNode.removeChild(e):r.innerHTML="",r.insertAdjacentHTML("beforeend",t))}function y(t,e,r){b(e?'<table class="'+e+'}"><caption>'+app.escapeHtml(t)+"</caption></table>":'<table><caption style="display:block; '+r+'">'+app.escapeHtml(t)+"</caption></table>")}if(null===g&&(g=r.querySelector('script[type="text/x-template"][data-footer]')),null===this.bind)return"";var n=t&&t[this.bind]?t[this.bind]:null;if(null!==(n=null===n&&void 0!==app.plugins.dataBind&&"function"==typeof app.plugins.dataBind.getBindValue?app.plugins.dataBind.getBindValue(this.bind,t):n))if(Array.isArray(n)&&0===n.length)null===this.emptyDataText?b('<table class="no-data"></table>'):b('<table class="no-data"><caption>'+app.escapeHtml(this.emptyDataText)+"</caption></table>");else{t=!0;if(t=!Array.isArray(n)||0<n.length&&"object"!=typeof n[0]?!1:t){if("string"==typeof this.columns)for(o=0,p=(l=this.columns.split(",")).length;o<p;o++)l[o]=l[o].trim();else l=Object.keys(n[0]);if(a=l,"string"==typeof this.labels){for(o=0,p=(a=this.labels.split(",")).length;o<p;o++)a[o]=a[o].trim();a.length!==l.length&&null===f&&(a=l)}var i=[],v="<table";if(this.tableAttr)for(var H=this.tableAttr.split(",").map(function(t){return t.trim()}),o=0,p=H.length;o<p;o++){var T=H[o],j=T.indexOf("=");1<j?(m=T.substring(0,j).trim(),s=T.substring(j+1).trim(),v+=" "+app.escapeHtml(m)+'="'+app.escapeHtml(s)+'"',"is"===m&&"sortable-table"===s&&(v+=" data-sort")):v+=" "+app.escapeHtml(T)}if(i.push(v+"><thead><tr>"),e=[],this.colClass){var t=this.colClass.split(",").map(function(t){return t.trim()}),E={};for(t.forEach(function(t){var e,r=t.indexOf("=");0<r&&(e=t.substring(0,r),t=t.substring(r+1),E[e]=t)}),o=0,p=a.length;o<p;o++){var C=a[o],x=null;void 0!==E[o.toString()]?x=E[o.toString()]:void 0!==E[C]&&(x=E[C]),x?e.push('<th class="'+app.escapeHtml(x)+'">'+app.escapeHtml(a[o])+"</th>"):e.push("<th>"+app.escapeHtml(a[o])+"</th>")}}else for(o=0,p=a.length;o<p;o++)e.push("<th>"+app.escapeHtml(a[o])+"</th>");if(i.push(e.join("")),i.push("</tr></thead>"),i.push("<tbody>"),null!==f)try{if(void 0===app.jsTemplate)throw Error("Error - When using <data-table> with a template the script [js/extensions/jsTemplate.js] is required.");for(var S=app.jsTemplate.compile(this.rowItemName,!1,f.innerHTML),L=0,k=n.length;L<k;L++){c=n[L];try{i.push(S(c,L,app.escapeHtml,app.format))}catch(t){this.errorClass?i.push('<tr class="'+this.errorClass+'">'):i.push('<tr style="'+this.defaultErrorStyle+'">'),i.push('<td colspan="'+l.length+'">Item Error - '+t.message+"</td></tr>")}}}catch(t){return void y("Error Rendering Template - "+t.message,this.errorClass,this.defaultErrorStyle)}else{var q=this.colLinkTemplate,w=null;for(q&&(w=this.colLinkFields?this.colLinkFields.split(",").map(function(t){return t.trim()}):[l[0]]),h=l.length,o=0,p=n.length;o<p;o++){for((e=[]).push("<tr>"),u=0;u<h;u++)d=l[u],s=null===(s=(c=n[o])[d])?"":app.escapeHtml(s),q&&-1!==w.indexOf(d)?e.push('<td><a href="'+app.buildUrl(q,c)+'">'+app.escapeHtml(s)+"</a></td>"):e.push("<td>"+s+"</td>");e.push("</tr>"),i.push(e.join(""))}}if(g){i.push("<tfoot>");var A=function(t){for(var e=[],r=0,l=n.length;r<l;r++){var a=n[r][t];switch(typeof a){case"number":e.push(a);break;case"string":a=parseFloat(a),isNaN(a)||e.push(a)}}return e};try{if(void 0===app.jsTemplate)throw Error("Error - When using <data-table> with a template the script [js/extensions/jsTemplate.js] is required.");var M=app.jsTemplate.compile(["sum","avg","max","min","count"],!1,g.innerHTML);try{i.push(M(function(t){return A(t).reduce(function(t,e){return t+e},0)},function(t){t=A(t);return t.reduce(function(t,e){return t+e},0)/t.length},function(t){return Math.max.apply(null,A(t))},function(t){return Math.min.apply(null,A(t))},function(){return n.length},app.escapeHtml,app.format))}catch(t){this.errorClass?i.push('<tr class="'+this.errorClass+'">'):i.push('<tr style="'+this.defaultErrorStyle+'">'),i.push('<td colspan="'+l.length+'">Footer Error - '+t.message+"</td></tr>")}}catch(t){return void y("Error Rendering Footer Template - "+t.message,this.errorClass,this.defaultErrorStyle)}i.push("</tfoot>")}i.push("</tbody>"),b(i.join("")),this.highlightClass&&r.querySelector("table").classList.add("click-to-highlight")}else y(this.errorInvalidData,this.errorClass,this.defaultErrorStyle)}}})}();