import{defineExtendsPolyfill}from"./utils.min.js";import{getSortObject,smartSort}from"./utils-sort.min.js";class SortableTable extends HTMLTableElement{constructor(){super()}connectedCallback(){this.setupTable()}setupTable(){const e=this;if(null===e.tHead)return console.warn("Unable to setup sorting for table because there is no <thead> element"),void console.log(e);if(0===e.tHead.rows.length)return console.warn("Unable to setup sorting for table because the <thead> element contained now rows"),void console.log(e);if(0===e.tBodies.length)return console.warn("Unable to setup sorting for table because the <tbody> element is missing"),void console.log(e);if(1!==e.tBodies.length)return console.warn("Unable to setup sorting for table because there can only be one <tbody> element for the table"),void console.log(e);const t=e.tHead.rows[e.tHead.rows.length-1];for(let e=0,l=t.cells.length;e<l;e++)this instanceof HTMLTableElement?t.cells[e].addEventListener("click",SortableTable.prototype.sortColumn):t.cells[e].addEventListener("click",this.sortColumn),t.cells[e].style.cursor="pointer"}sortColumn(e){const t=e.target,l=t&&t.parentElement&&t.parentElement.parentElement?t.parentElement.parentElement.parentElement:null;if("TH"!==t.tagName&&"TD"!==t.tagName)return console.warn("SortableTable.sortColumn() was called with an invalid element. If called manually the cell needs to be passed."),void console.log(t);if(null!=l&&"TABLE"!==l.tagName)return console.warn("SortableTable.sortColumn() was called with an invalid element. If called manually the table cell of the last row from the table header should be used."),void console.log(t);const o=l.getAttribute("data-sort-column"),s=t.cellIndex;let n="asc";if(null!==o&&parseInt(o,10)===s){n="asc"===l.getAttribute("data-sort-order")?"desc":"asc"}const a=l.tBodies[0],r=a.rows,c=[];for(let e=0,t=r.length;e<t;e++){const t=r[e].cells[s];if(void 0===t){console.warn("Unexpected table format for sorting"),console.log(r[e]);continue}const l=t.getAttribute("data-value");let o=null!==l?l.trim():t.textContent.trim();c.push(getSortObject(r[e],o))}c.sort(smartSort),"desc"===n&&c.reverse();const i=l.getAttribute("data-sort-class-odd"),d=l.getAttribute("data-sort-class-even"),b=i&&d;let u=0;for(let e=0,t=c.length;e<t;e++){const t=c[e].el;b&&"none"!==t.style.display&&(u++,u%2==0?(t.classList.add(d),t.classList.remove(i)):(t.classList.add(i),t.classList.remove(d))),a.appendChild(t)}l.setAttribute("data-sort-column",s),l.setAttribute("data-sort-order",n)}}window.customElements.define("sortable-table",SortableTable,{extends:"table"}),defineExtendsPolyfill("sortable-table","table",(e=>{SortableTable.prototype.setupTable.apply(e)}));